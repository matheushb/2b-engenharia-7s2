<p align="center">
  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="200" alt="Nest Logo" /></a>
</p>

[circleci-image]: https://img.shields.io/circleci/build/github/nestjs/nest/master?token=abc123def456
[circleci-url]: https://circleci.com/gh/nestjs/nest

## Description

Simple base API for User and Task management

- Authentication (JWT)
- Authorization (RBAC)
- Documentation (Swagger)
- Exception Handler
- Pagination
- ORM (Prisma with PostgreSQL)
- Tests

### User

Represents the entity that provides access

- **id:** CUID unique identifier for the user, automatically generated by Prisma.
- **name:** User's name, optional.
- **email:** User's email, must be unique.
- **password:** User's password, stored encrypted in the database.
- **role:** User's role, default value is `USER`. An `ADMIN` user can only be created directly in the database.
- **created_at:** Date and time the entity was created, default value is now().
- **updated_at:** Date and time the entity was last updated, automatically updated.

### Task

Represents a task entity that belongs to a user

- **id:** CUID unique identifier for the task, automatically generated by Prisma.
- **title:** Task's title, required.
- **description:** Task's description, optional.
- **completed:** Task's completion status, default value is `false`.
- **user_id:** Reference to the user who owns the task.
- **created_at:** Date and time the entity was created, default value is now().
- **updated_at:** Date and time the entity was last updated, automatically updated.

### API Endpoints

#### Authentication

- `POST /v1/auth/signin` - Sign in with email and password
- `POST /v1/auth/signup` - Create a new user account
- `GET /v1/auth/profile` - Get current user profile (requires authentication)

#### Users (Admin only)

- `POST /v1/users` - Create a new user (admin only)
- `GET /v1/users` - List all users with pagination (admin only)
- `GET /v1/users/:id` - Get user by ID (admin only)
- `PATCH /v1/users/:id` - Update user by ID (admin only)
- `DELETE /v1/users/:id` - Delete user by ID (admin only)
- `PATCH /v1/users/update/me` - Update current user profile

#### Tasks (Authenticated users)

- `POST /v1/tasks` - Create a new task
- `GET /v1/tasks` - List user's tasks with pagination and filters
- `GET /v1/tasks/:id` - Get task by ID
- `PATCH /v1/tasks/:id` - Update task by ID
- `DELETE /v1/tasks/:id` - Delete task by ID

# API Documentation

## 1. Installation Steps

### 1.1 Clone the Repository

Clone the API repository using the command below:

```bash
git clone https://github.com/matheushb/nestjs-base-project.git
```

Then, enter the project directory:

```bash
cd nestjs-base-project
```

### 1.2 Install Dependencies

```bash
npm install
```

### 1.3 Configure Environment Variables

Copy the .env.example file to a new file called .env:

```bash
cp .env.example .env
```

### 1.4 Initialize Docker

Make sure Docker is running, then run the command

```bash
docker-compose up -d
```

### 1.5 Migrate database

To apply migration on database, execute the command:

```bash
npx prisma migrate dev
```

## 2. Starting the API

To run the API execute:

```bash
# development
$ npm run start

# watch mode
$ npm run start:dev

# production mode
$ npm run start:prod
```

## 3. Running tests

With docker running, execute the following commmand:

```bash
npm run test
```

## 4. Swagger documentation

```bash
GET /api
```
